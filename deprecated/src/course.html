<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LJPS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Brand</a>
            
            
        </div>
    </nav>

    <div id="main-container" class="container">
        <h1 id='courseCount' class="display-4"></h1>
        <div id="courseDetails" class="container"></div>
        <br>
        <script>
            function showError(message) {
                // Hide the table and button in the event of error
                $('#coursesTable').hide();
                $('#addCourseBtn').hide();

                // Display an error under the main container
                $('#main-container')
                    .append("<label>" + message + "</label>");
            }

            $(async () => {
                // Change serviceURL to your own
                var serviceURL = "http://127.0.0.1:5000/course";

                try {
                    const response =
                        await fetch(
                            serviceURL, { method: 'GET' }
                        );
                    const result = await response.json();
                    if (response.status === 200) {
                        // success case
                        var courses = result.data.course;
                        var courseCount = 0;
                        // the returned result
                        // for loop to setup all table rows with obtained course data
                        var rows = "";
                        for (const course of courses) {
                            // display only active courses
                            if (course.Course_Status == 'Active') { // status - Retired / Active
                                eachRow = "<div class='col'><div class='card h-100'>" +
                                    "<img src='https://via.placeholder.com/780x520.png?text=Placeholder+Image' class='card-img-top' alt='Hollywood Sign on The Hill'/>" +
                                    "<div class='card-body'>" +
                                    "<h5 class='card-title'>" + course.Course_Name + "</h5>" +
                                    "<p class='card-text'>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>" +
                                    "<a style='position:absolute;bottom:5px;right:5px;margin:0;padding:5px 3px;' href='#' class='btn btn-primary'>" + course.Course_Type + "</a>" +
                                    "</div></div></div>"
                                courseCount += 1
                                rows += eachRow;
                            }
                        }
                        // add all the rows to the table
                        output = "<div class='row row-cols-1 row-cols-md-3 g-4'>" + rows + "</div>"
                        courseCountHeader = courseCount + " courses available"
                        $('#courseDetails').append(output);
                        $('#courseCount').append(courseCountHeader);

                    } else if (response.status == 404) {
                        // No courses
                        showError(result.message);
                    } else {
                        // unexpected outcome, throw the error
                        throw response.status;
                    }
                } catch (error) {
                    // Errors when calling the service; such as network error, 
                    // service offline, etc
                    showError
                        ('There is a problem retrieving courses data, please try again later.<br />' + error);
                } // error
            });

        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8"
            crossorigin="anonymous"></script>
</body>

</html>